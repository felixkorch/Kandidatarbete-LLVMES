#macro PAGE_COUNT 0 #8 #endmacro

.org $8000

list:

.db 3, 2, 1, 7, 8, 4, 5, 6
.db 10, 9, 11, 15, 13, 14, 12, 3
.db 2, 1, 7, 8, 4, 5, 6, 10
.db 9, 11, 15, 13, 14, 12, 103, 129
.db 240, 182, 171, 255, 97, 79, 59, 144
.db 31, 3, 46, 215, 203, 79, 37, 252
.db 241, 184, 43, 11, 170, 71, 53, 192
.db 100, 166, 115, 211, 164, 150, 203, 207
.db 165, 196, 96, 123, 7, 112, 20, 213

.db 135, 43, 103, 83, 204, 84, 98, 30
.db 175, 190, 163, 194, 181, 94, 172, 165
.db 122, 201, 107, 81, 88, 61, 182, 167
.db 43, 210, 191, 204, 190, 71, 89, 100
.db 82, 92, 199, 64, 158, 35, 33, 91
.db 254, 70, 1, 32, 126, 188, 130, 37
.db 135, 42, 173, 86, 254, 16, 218, 97
.db 4, 30, 55, 45, 194, 171, 240, 231
.db 113, 175, 99, 92, 143, 200, 250, 190

.db 110, 205, 58, 49, 244, 54, 166, 243
.db 182, 219, 145, 157, 108, 163, 226, 184
.db 50, 200, 48, 158, 133, 190, 220, 72
.db 50, 98, 74, 117, 201, 84, 73, 9
.db 233, 122, 236, 214, 151, 173, 173, 75
.db 248, 182, 75, 66, 161, 179, 62, 148
.db 30, 146, 190, 4, 130, 76, 233, 238
.db 45, 140, 15, 239, 221, 42, 172, 22

.db 4, 157, 66, 192, 182, 85, 148, 136
.db 223, 8, 126, 28, 193, 184, 103, 158
.db 105, 78, 177, 173, 92, 14, 35, 36
.db 183, 177, 70, 127, 7, 215, 56, 191
.db 115, 152, 9, 154, 188, 217, 97, 253
.db 57, 233, 27, 198, 117, 98, 128, 43
.db 31, 136, 201, 242, 75, 144, 2, 89
.db 101, 121, 180, 0, 108, 65, 75, 159
.db 6, 37, 218, 44, 237, 186, 237, 59

.db 57, 115, 139, 170, 25, 164, 107, 127
.db 162, 145, 144, 5, 54, 133, 80, 39
.db 63, 250, 109, 237, 205, 13, 158, 159
.db 167, 9, 8, 86, 29, 97, 184, 186
.db 74, 15, 104, 98, 42, 28, 55, 140
.db 119, 185, 17, 160, 24, 218, 105, 173
.db 102, 180, 194, 111, 242, 63, 222, 68
.db 102, 159, 172, 41, 62, 219, 77, 26
.db 41, 236, 129, 219, 185, 167, 56, 9

.db 66, 194, 59, 53, 155, 72, 93, 95
.db 204, 203, 94, 231, 163, 6, 35, 254
.db 210, 85, 241, 120, 175, 138, 159, 161
.db 238, 52, 223, 146, 21, 227, 107, 204
.db 16, 237, 126, 108, 193, 170, 222, 145
.db 217, 108, 209, 197, 68, 221, 14, 188
.db 12, 131, 41, 81, 180, 71, 184, 122
.db 122, 0, 82, 65, 108, 255, 57, 245
.db 236, 23, 163, 122, 51, 27, 143, 37

.db 248, 173, 13, 92, 6, 217, 4, 238
.db 25, 75, 114, 146, 232, 231, 237, 132
.db 204, 92, 73, 36, 190, 4, 81, 186
.db 98, 180, 143, 32, 82, 205, 181, 120
.db 133, 190, 161, 235, 12, 179, 92, 144
.db 96, 205, 115, 69, 136, 15, 167, 98
.db 67, 142, 82, 33, 128, 212, 42, 209
.db 255, 88, 82, 247, 1, 41, 81, 220
.db 244, 54, 79, 78, 217, 228, 193, 226

.db 13, 220, 243, 65, 14, 60, 52, 132
.db 91, 84, 66, 247, 173, 216, 239, 141
.db 167, 93, 77, 232, 60, 237, 125, 165
.db 176, 12, 208, 42, 28, 194, 92, 12
.db 136, 48, 254, 1, 148, 89, 207, 137
.db 24, 7, 250, 181, 26, 3, 234, 202
.db 58, 215, 157, 227, 64, 2, 78, 210
.db 90, 198, 208, 52, 102, 232, 40, 180
.db 175, 91, 48, 181, 139, 90, 97, 70

.db 80, 234, 244, 99, 152, 29, 173, 96
.db 45, 91, 85, 158, 9, 152, 165, 218
.db 149, 119, 45, 225, 238, 81, 197, 228
.db 194, 1, 186, 251, 43, 204, 108, 31
.db 53, 62, 178, 171, 221, 122, 213, 40
.db 101, 204, 123, 89, 201, 61, 34, 72
.db 203, 201, 189, 130, 255, 26, 56, 23
.db 190, 123, 6, 253, 244, 247, 32, 216
.db 5, 79, 167, 42, 126, 70, 51, 147

.db 107, 138, 80, 243, 127, 158, 148, 45
.db 177, 245, 142, 54, 48, 18, 72, 179
.db 5, 24, 23, 134, 120, 14, 229, 207
.db 153, 12, 93, 172, 114, 183, 14, 227
.db 44, 219, 179, 143, 182, 2, 104, 33
.db 161, 179, 252, 205, 31, 144, 215, 184
.db 159, 37, 134, 241, 183, 0, 211, 104
.db 29, 7, 165, 79, 28, 44, 239, 34
.db 50, 91, 19, 185, 60, 59, 158, 157

.db 79, 164, 216, 196, 166, 215, 242, 18
.db 14, 50, 59, 36, 165, 240, 80, 130
.db 215, 157, 15, 90, 150, 31, 7, 219
.db 70, 143, 69, 69, 181, 94, 131, 87
.db 169, 139, 128, 215, 163, 56, 132, 52
.db 173, 67, 66, 218, 174, 92, 250, 159
.db 115, 209, 65, 224, 10, 144, 27, 152
.db 18, 113, 231, 128, 229, 90, 84, 48
.db 254, 82, 37, 122, 3, 115, 245, 147

.db 101, 43, 186, 109, 48, 15, 124, 238
.db 191, 80, 157, 245, 204, 68, 245, 127
.db 166, 63, 103, 136, 67, 89, 0, 96
.db 62, 231, 15, 166, 51, 27, 203, 27
.db 20, 209, 135, 10, 174, 187, 255, 38
.db 46, 108, 207, 60, 26, 152, 60, 114
.db 72, 57, 130, 127, 219, 102, 126, 36
.db 190, 49, 26, 94, 101, 121, 86, 14
.db 205, 105, 149, 102, 46, 243, 125, 110

.db 214, 96, 165, 119, 212, 20, 4, 150
.db 190, 148, 251, 246, 6, 187, 96, 50
.db 179, 72, 57, 158, 184, 148, 217, 130
.db 195, 225, 241, 82, 174, 59, 89, 131
.db 4, 149, 18, 123, 41, 136, 235, 40
.db 18, 174, 32, 85, 149, 27, 169, 201
.db 148, 150, 183, 174, 239, 86, 115, 43
.db 63, 131, 196, 250, 189, 143, 24, 89
.db 91, 50, 183, 168, 226, 234, 160, 123

.db 2, 88, 210, 93, 171, 19, 110, 202
.db 197, 241, 24, 61, 228, 132, 195, 251
.db 149, 25, 119, 147, 13, 21, 119, 229
.db 28, 35, 8, 11, 22, 190, 196, 35
.db 148, 192, 249, 238, 169, 193, 231, 213
.db 172, 219, 67, 44, 209, 241, 125, 168
.db 95, 18, 14, 173, 238, 121, 38, 44
.db 195, 208, 53, 246, 235, 22, 252, 73
.db 170, 14, 24, 166, 83, 173, 189, 126

.db 84, 156, 232, 44, 48, 207, 207, 110
.db 228, 11, 75, 177, 132, 55, 82, 197
.db 120, 88, 114, 231, 209, 125, 117, 173
.db 226, 93, 140, 106, 43, 40, 50, 119
.db 197, 3, 8, 207, 10, 215, 178, 158
.db 200, 194, 192, 246, 78, 71, 19, 157
.db 139, 48, 3, 83, 63, 138, 111, 184
.db 141, 197, 28, 16, 95, 74, 193, 177
.db 239, 162, 101, 13, 56, 116, 82, 115

.db 65, 98, 119, 181, 149, 206, 152, 146
.db 224, 226, 85, 178, 62, 107, 248, 151
.db 81, 149, 250, 102, 4, 207, 113, 175
.db 85, 173, 222, 196, 43, 106, 186, 101
.db 163, 105, 97, 90, 222, 3, 227, 185
.db 118, 138, 189, 129, 178, 10, 101, 163
.db 203, 33, 107, 82, 253, 210, 92, 48
.db 227, 28, 181, 219, 184, 42, 111, 57
.db 159, 180, 119, 125, 66, 145, 232, 40

.db 196, 72, 119, 96, 19, 74, 100, 114
.db 57, 71, 210, 114, 132, 144, 235, 88
.db 237, 237, 205, 81, 46, 140, 67, 123
.db 57, 149, 183, 255, 79, 162, 52, 140
.db 243, 127, 26, 142, 113, 129, 134, 54
.db 144, 180, 68, 199, 171, 94, 147, 141
.db 183, 131, 246, 115, 172, 184, 130, 133
.db 72, 152, 197, 227, 4, 77, 199, 161
.db 244, 223, 70, 164, 239, 232, 208, 52

.db 229, 206, 3, 193, 109, 106, 172, 16
.db 65, 145, 21, 118, 235, 220, 197, 183
.db 235, 190, 111, 54, 242, 63, 84, 111
.db 71, 49, 184, 216, 194, 216, 123, 101
.db 253, 74, 116, 250, 204, 116, 226, 214
.db 116, 123, 93, 171, 176, 15, 107, 226
.db 52, 128, 113, 96, 117, 143, 250, 151
.db 211, 27, 195, 150, 39, 15, 8, 43
.db 243, 100, 59, 127, 199, 238, 161, 91

.db 56, 188, 102, 117, 33, 78, 156, 27
.db 40, 83, 113, 100, 120, 157, 204, 129
.db 118, 94, 90, 226, 80, 62, 66, 46
.db 16, 155, 241, 89, 47, 52, 183, 112
.db 123, 63, 154, 215, 55, 144, 215, 252
.db 181, 1, 22, 77, 41, 163, 254, 197
.db 170, 253, 158, 67, 234, 245, 53, 105
.db 111, 255, 136, 196, 231, 125, 213, 25
.db 244, 214, 20, 81, 15, 47, 131, 219

.db 131, 163, 202, 106, 179, 125, 103, 84
.db 20, 254, 236, 150, 11, 152, 132, 248
.db 211, 94, 203, 82, 245, 212, 116, 134
.db 93, 218, 223, 229, 226, 108, 16, 0
.db 235, 234, 193, 174, 181, 133, 96, 37
.db 132, 169, 173, 58, 42, 17, 236, 84
.db 222, 186, 240, 140, 66, 190, 255, 23
.db 42, 97, 248, 251, 91, 66, 120, 115
.db 114, 99, 124, 241, 206, 62, 3, 135

.db 212, 252, 6, 253, 92, 250, 245, 218
.db 169, 251, 3, 172, 132, 252, 223, 199
.db 27, 198, 239, 82, 84, 229, 60, 148
.db 6, 36, 159, 57, 15, 236, 1, 87
.db 63, 21, 75, 155, 192, 85, 45, 58
.db 126, 15, 171, 91, 106, 252, 99, 141
.db 115, 64, 237, 159, 40, 77, 199, 84
.db 101, 1, 150, 217, 65, 193, 25, 142
.db 99, 168, 193, 123, 79, 67, 156, 248

.db 50, 54, 216, 163, 195, 127, 204, 166
.db 41, 48, 121, 158, 237, 201, 47, 63
.db 12, 196, 132, 250, 46, 107, 17, 237
.db 13, 69, 205, 115, 3, 95, 214, 44
.db 31, 153, 242, 19, 210, 188, 166, 139
.db 125, 233, 17, 242, 195, 189, 21, 182
.db 132, 202, 201, 19, 8, 119, 240, 102
.db 237, 204, 235, 213, 112, 152, 53, 196
.db 204, 183, 230, 17, 5, 199, 194, 124

.db 113, 162, 42, 124, 186, 57, 144, 164
.db 93, 237, 209, 15, 75, 47, 216, 147
.db 103, 202, 88, 98, 150, 224, 162, 45
.db 63, 71, 252, 32, 99, 137, 14, 159
.db 209, 23, 252, 1, 63, 77, 6, 3
.db 183, 20, 19, 188, 40, 43, 23, 85
.db 226, 154, 114, 192, 61, 242, 141, 77
.db 146, 51, 91, 241, 47, 3, 205, 142
.db 151, 61, 14, 234, 20, 168, 83, 170

.db 150, 116, 82, 113, 41, 201, 47, 235
.db 98, 110, 195, 131, 93, 22, 76, 161
.db 54, 139, 32, 36, 133, 219, 47, 180
.db 240, 42, 147, 78, 40, 46, 236, 82
.db 222, 57, 25, 123, 106, 121, 96, 24
.db 221, 14, 228, 244, 37, 212, 60, 48
.db 111, 5, 213, 116, 19, 19, 237, 203
.db 36, 81, 97, 75, 243, 209, 86, 100
.db 202, 42, 37, 104, 44, 198, 125, 112

.db 123, 131, 220, 89, 139, 200, 241, 142
.db 115, 74, 214, 40, 2, 202, 104, 66
.db 79, 191, 32, 98, 255, 188, 122, 225
.db 171, 65, 157, 200, 110, 162, 215, 207
.db 95, 222, 182, 135, 161, 160, 36, 70
.db 97, 200, 50, 64, 96, 118, 33, 237
.db 127, 115, 145, 184, 208, 5, 12, 56
.db 89, 173, 159, 38, 4, 224, 135, 60
.db 66, 92, 146, 127, 149, 234, 97, 68

.db 227, 148, 100, 90, 223, 133, 124, 108
.db 32, 37, 109, 108, 11, 69, 71, 17
.db 120, 199, 16, 222, 208, 90, 159, 140
.db 182, 41, 64, 248, 101, 143, 216, 97
.db 24, 44, 135, 117, 152, 3, 49, 153
.db 79, 203, 52, 213, 35, 14, 255, 42
.db 13, 245, 182, 224, 177, 56, 48, 101
.db 254, 135, 175, 64, 23, 130, 25, 183
.db 23, 234, 38, 210, 56, 0, 53, 179

.db 234, 251, 180, 139, 61, 243, 248, 39
.db 208, 142, 41, 70, 44, 7, 55, 198
.db 28, 227, 64, 158, 108, 25, 202, 172
.db 74, 175, 222, 211, 71, 89, 36, 93
.db 153, 182, 249, 59, 2, 237, 226, 20
.db 184, 184, 58, 169, 114, 187, 122, 70
.db 150, 116, 93, 166, 177, 161, 182, 152
.db 153, 88, 251, 180, 17, 169, 147, 20
.db 51, 119, 29, 138, 150, 127, 123, 170

.db 30, 38, 15, 47, 13, 217, 141, 118
.db 98, 172, 66, 98, 184, 9, 234, 153
.db 68, 103, 162, 206, 94, 76, 102, 81
.db 199, 177, 204, 134, 140, 2, 89, 237
.db 157, 162, 195, 109, 153, 7, 190, 62
.db 136, 63, 189, 62, 249, 12, 126, 242
.db 149, 248, 131, 157, 174, 178, 80, 108
.db 72, 99, 104, 209, 86, 68, 94, 83
.db 197, 174, 218, 180, 162, 194, 148, 67

.db 29, 86, 5, 88, 49, 248, 214, 2
.db 43, 181, 81, 209, 41, 193, 254, 233
.db 125, 91, 102, 214, 9, 143, 246, 196
.db 102, 62, 79, 224, 67, 182, 213, 123
.db 148, 129, 79, 128, 8, 79, 255, 239
.db 15, 39, 93, 238, 4, 51, 87, 183
.db 3, 225, 106, 243, 191, 152, 22, 5
.db 106, 40, 195, 149, 145, 28, 20, 250
.db 110, 123, 189, 22, 226, 136, 15, 2

.db 135, 43, 103, 83, 204, 84, 98, 30
.db 175, 190, 163, 194, 181, 94, 172, 165
.db 122, 201, 107, 81, 88, 61, 182, 167
.db 43, 210, 191, 204, 190, 71, 89, 100
.db 82, 92, 199, 64, 158, 35, 33, 91
.db 254, 70, 1, 32, 126, 188, 130, 37
.db 135, 42, 173, 86, 254, 16, 218, 97
.db 4, 30, 55, 45, 194, 171, 240, 231
.db 113, 175, 99, 92, 143, 200, 250, 190

.db 110, 205, 58, 49, 244, 54, 166, 243
.db 182, 219, 145, 157, 108, 163, 226, 184
.db 50, 200, 48, 158, 133, 190, 220, 72
.db 50, 98, 74, 117, 201, 84, 73, 9
.db 233, 122, 236, 214, 151, 173, 173, 75
.db 248, 182, 75, 66, 161, 179, 62, 148
.db 30, 146, 190, 4, 130, 76, 233, 238
.db 45, 140, 15, 239, 221, 42, 172, 22

.db 4, 157, 66, 192, 182, 85, 148, 136
.db 223, 8, 126, 28, 193, 184, 103, 158
.db 105, 78, 177, 173, 92, 14, 35, 36
.db 183, 177, 70, 127, 7, 215, 56, 191
.db 115, 152, 9, 154, 188, 217, 97, 253
.db 57, 233, 27, 198, 117, 98, 128, 43
.db 31, 136, 201, 242, 75, 144, 2, 89
.db 101, 121, 180, 0, 108, 65, 75, 159
.db 6, 37, 218, 44, 237, 186, 237, 59

main:
    LDA #<list ; A = list_L
    LDX #>list ; X = list_H
    STA $00    ; List address will be on ZP $00
    STX $01
main_loop:
    LDA is_sorted
    BNE done
    LDA #1
    STA is_sorted ; Before looping, set done to true (the algorithm will set it to false if it's not done)
    LDA base_page
    STA $01  ; Reset page
    LDA #0
    STA page_index ; Reset page index
    LDY #0   ; Reset iterator
pass:
    LDA ($00), Y ; A = first element
    CPY #$FF
    BEQ inc_page
    INY
pass_cmp:
    CMP ($00), Y ; Compare to next element
    BEQ pass     ; If ==, goto next
    BCS swap     ; If >, goto 'swap'. If < goto next
    JMP pass
inc_page:
    INC $01        ; Increase page by 1
    INC page_index       
    LDY PAGE_COUNT
    CPY page_index ; If == to page count, go to next main_loop
    BEQ main_loop
    LDY #0
    JMP pass_cmp
swap:
    LDX #0
    STX is_sorted ; Swap means done = false
    CPY #0
    BEQ page_edge_swap
    STA tmp
    LDA ($00), Y
    DEY
    STA ($00), Y
    INY
    LDA tmp
    STA ($00), Y
    JMP pass
page_edge_swap:
    STA tmp
    LDA ($00), Y
    DEY
    DEC $01
    STA ($00), Y
    INY
    INC $01
    LDA tmp
    STA ($00), Y
    JMP pass

done:
    LDY #0  ; Reset iterator
    LDA base_page
    STA $01 ; Reset page
    LDA #0
    STA page_index ; Reset page index
print_loop:
    LDA ($00), Y
    STA $2009
    INY
    CPY #$FF
    BEQ print_inc_page
    JMP print_loop
print_inc_page:
    INC $01        ; Increase page by 1
    INC page_index       
    LDY PAGE_COUNT
    CPY page_index ; If == to page count, go to next main_loop
    BEQ exit
    LDY #0         ; Else, clear Y and start on next page
    JMP print_loop
exit:
    LDA #0
    STA $200F ; Exit 0

is_sorted:
.db 0

tmp:
.db 0

base_page:
.db $80

page_index:
.db 0



.org $FFFC
.dw main ; Reset routine
